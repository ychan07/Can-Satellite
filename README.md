# 🌌 캔위성 기반 21cm 중성수소선 관측 프로젝트

## ✅ 프로젝트 목표 
- 지상에서 고도가 높아질 수록 전파간섭이 적어질 것이라는 가설 검증
- 관측된 데이터를 토대로 과학적인 분석 수행

## 🛰 프로젝트 개요

- **위성 플랫폼**: 캔위성 (CanSat)  
- **탑재 컴퓨팅 장치**: Raspberry Pi Zero W  
- **관측 방식**: SDR을 이용한 21cm 전파 수신  
- **보정 과정**:  
  1. **1차 보정**: IMU/GPS 데이터를 기반으로 확장 칼만 필터(EKF)를 사용한 물리 역계산  
  2. **2차 보정**: 디퓨전 AI를 이용한 정밀 보정  
- **지상국 역할**: 수신 데이터 후처리 및 시각화  

---

## 📦 시스템 구성

### 캔위성 탑재 장비

- **Raspberry Pi Zero W**: 센서 제어 및 데이터 수집  
- **SDR 모듈**: 21cm 중성수소선 전파 수신  
- **IMU 센서**: 위성의 자세 정보 측정  
- **GPS 모듈**: 시간 동기화 및 위치 정보 획득  

### 지상국

- **1차 보정 (역계산)**: EKF를 통한 위치/자세 보정  
- **2차 보정 (AI)**: 디퓨전 모델을 통한 노이즈 제거 및 스펙트럼 정제  
- **시각화**: 보정 전후 데이터의 비교 시각화  

---

## 🔄 데이터 처리 흐름

```
[IMU / GPS 데이터 수집]
           ↓
[확장 칼만 필터 (EKF) 보정]
           ↓
[SDR로 중성수소선 관측]
           ↓
[전처리 작업으로 x축 속도로 변경]
           ↓
[센서 데이터 기반 1차 보정]
           ↓
[오차 포함 데이터 → 디퓨전 AI]
           ↓
[보정 완료 데이터 시각화 및 저장]
```

---

## 🧠 AI 기반 보정 (2차 보정)

- **모델 종류**: Conditional Diffusion Model  
- **입력**: 오차/노이즈가 포함된 관측 데이터  
- **목표 출력**: 정제된 고신뢰 관측 데이터  
- **학습 데이터**: 실제 관측 데이터에 인위적 노이즈/편이/결측을 추가하여 생성한 입력-정답 쌍  

---

## 🛠 기술 스택

| 구성 요소      | 기술/장비                              |
|----------------|----------------------------------------|
| 센서 제어      | Python (Raspberry Pi)                  |
| SDR 제어       | GNU Radio, rtl-sdr                     |
| EKF 보정       | NumPy, SciPy, Custom EKF 코드          |
| AI 보정        | PyTorch, Huggingface Diffusers         |
| 시각화         | Matplotlib, Seaborn, FITS viewer       |

---

## 📁 디렉토리 구조 (임시)

```
cansat-hi-project/
├── can_sat/
│   ├── imu_gps_logger.py         # IMU/GPS 데이터 수집
│   ├── sdr_receiver.py           # 21cm 스펙트럼 수신
│   └── ekf_filter.py             # 확장 칼만 필터 보정
├── ground_station/
│   ├── data_loader.py
│   ├── diffusion_model/
│   │   ├── train.py              # 디퓨전 모델 학습 코드
│   │   └── model.py              # 디퓨전 모델 구조 정의
│   └── visualize.py              # 보정 결과 시각화
├── data/
│   ├── raw/                      # 원시 관측 데이터(관측)
│   ├── corrected/                # 보정된 데이터(관측)
│   └── synthetic_pairs/          # AI 학습용 데이터쌍(수집, 생성)
└── README.md
```

---

## 🚀 향후 계획

- [ ] 실제 관측 데이터 업로드 및 공개  
- [ ] EKF 보정 성능 리포트 추가  
- [ ] 디퓨전 모델 fine-tuning 및 성능 개선  
- [ ] 웹 기반 실시간 스펙트럼 시각화 기능 추가  
- [ ] ai의 보정 결과물의 신뢰도를 평가하기 위해 MC dropout사용
---
